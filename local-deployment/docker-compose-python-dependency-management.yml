# docker-compose.yml for Python Dependency Management
#
# This file defines a service for an interactive Python project management environment.
# It mounts the project root to /workspace and allows running Poetry/PDM commands inside Docker.
# Usage: docker-compose run --rm dev bash

# IMPORTANT:
# Set a unique Compose project name per repo. Otherwise Docker Compose can derive the project name
# from the folder name (e.g. "local-deployment"), leading to cross-repo collisions (containers,
# networks, volumes like "<project>-app-1").
name: python-api-template

services:
  dev:
    build:
      context: ../python-dependency-management
      dockerfile: Dockerfile
      args:
        PYTHON_VERSION: ${PYTHON_VERSION}
    image: python-dependency-management:latest
    volumes:
      - ..:/workspace
    working_dir: /workspace
    tty: true
    stdin_open: true
    user: "${UID:-1000}:${GID:-1000}"
    env_file:
      - ../python-dependency-management/config.env
      - ../.env
    environment:
      - PIPX_HOME=/home/devuser/.local/pipx
      - PIPX_BIN_DIR=/home/devuser/.local/bin
      - PATH=/home/devuser/.local/bin:$PATH